package com.sina.weibo.agent.plugin

object EnvWhitelist {

    private val EXACT_KEYS = setOf(
        "PATH",
        "JAVA_HOME",
        "GOROOT",
        "GOPATH",
        "LANG",
    )

    private val PREFIX_KEYS = listOf(
        "ANDROID_",
        "ANT_",
        "APM_",
        "APPLE_",
        "APP_",
        "AWS_",
        "AZURE_",
        "BABEL_",
        "BOOT_",
        "BROWSER_",
        "BUILD_",
        "BUNDLE_",
        "CACHE_",
        "CHROME_",
        "CI_",
        "COMPOSE_",
        "CARGO_",
        "CYPRESS_",
        "DB_",
        "DEBUG_",
        "DOCKER_",
        "DOTNET_",
        "ELECTRON_",
        "ESLINT_",
        "FIREBASE_",
        "FLUTTER_",
        "GATSBY_",
        "GCP_",
        "GEM_",
        "GIT_",
        "GITHUB_",
        "GITLAB_",
        "GO_",
        "GOOGLE_",
        "GRADLE_",
        "HELM_",
        "HOME_",
        "HOST_",
        "IMAGE_",
        "JAVA_",
        "JEST_",
        "KAFKA_",
        "KUBECONFIG",
        "LERNA_",
        "MAVEN_",
        "MIX_",
        "MONGO_",
        "MYSQL_",
        "NEXT_",
        "NGINX_",
        "NODE_",
        "NPM_",
        "NVM_",
        "NUXT_",
        "OPENAI_",
        "PGPASS_",
        "PNPM_",
        "PORT",
        "POSTGRES_",
        "PROMETHEUS_",
        "PUBLIC_",
        "PYTHON_",
        "RAILS_",
        "REDIS_",
        "REACT_",
        "RUST_",
        "SASS_",
        "SENTRY_",
        "SERVER_",
        "SPRING_",
        "SQL_",
        "SSR_",
        "SWC_",
        "TAILWIND_",
        "TF_",
        "TYPESCRIPT_",
        "TZ",
        "UBUNTU_",
        "VITE_",
        "VUE_",
        "WEBPACK_",
        "YARN_",
        "AI21_",
        "ANTHROPIC_",
        "ANYSCALE_",
        "AZURE_OPENAI_",
        "CLARIFAI_",
        "COHERE_",
        "DEEPINFRA_",
        "DEEPSEEK_",
        "FIREWORKS_",
        "GROQ_",
        "HUGGINGFACE_",
        "JINA_",
        "MISTRAL_",
        "MLX_",
        "MODAL_",
        "NVIDIA_",
        "OLLAMA_",
        "PALM_",
        "REPLICATE_",
        "RUNPOD_",
        "SAGEMAKER_",
        "STABILITY_",
        "TOGETHER_",
        "VLLM_",
        "WORKERS_AI_",
        "PYENV_",
        "SDKMAN_",
        "CONDA_",
        "BUN_",
        "VSCODE_",
        "GEMINI_CLI_",
        "ZGSM_",
        "JETBRAINS_",
        "GEMINI_",
        "LC_",
        "RUBY_"
    )

    fun filter(env: Map<String, String>): Map<String, String> {
        return env.filter { (key, _) ->
            key in EXACT_KEYS || PREFIX_KEYS.any { key.startsWith(it) }
        }
    }
}
